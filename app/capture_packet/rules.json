[
  {
    "uuid": "rule-union-select-001",
    "group_id": "SQLI",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)\\bunion\\b[\\s\\S]{0,120}?\\bselect\\b",
    "use_aho": false,
    "message": "Possible SQL injection: UNION ... SELECT",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rule-drop-table-001",
    "group_id": "SQLI",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)\\bdrop\\s+table\\b|\\bdrop\\s+database\\b",
    "use_aho": true,
    "message": "Possible destructive SQL command (DROP)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rule-tautology-001",
    "group_id": "SQLI",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)\\b(?:or|and)\\b[\\s%+\\(\\)]{0,8}1[\\s%+\\)]{0,8}=[\\s%+\\(\\)]{0,8}1\\b",
    "use_aho": true,
    "message": "Possible SQL injection: boolean tautology (e.g. or 1=1)",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rule-sql-comment-001",
    "group_id": "SQLI",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)(?:--|/\\*).*?(?:select|insert|update|delete|union|drop|alter)\\b",
    "use_aho": true,
    "message": "SQL comment marker used near SQL keywords — suspicious",
    "severity": "low",
    "action": "log",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "susp_single_char_001",
    "group_id": "INPUT_NOISE",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?s)^(?:['\\\"]?)?(?:-| |&|\\^|\\*)(?:['\\\"]?)?$",
    "use_aho": false,
    "message": "Suspicious single-character payload (possible tampering / noise)",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_tautology_or_001",
    "group_id": "SQLI_TAUTOLOGY",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\bOR\\b)\\s*(?:TRUE|1\\s*=\\s*1)\\s*(?:--|#|/\\*|$)",
    "use_aho": false,
    "message": "SQL tautology detected (OR TRUE or OR 1=1 with optional comment)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_x_eq_x_001",
    "group_id": "SQLI_TAUTOLOGY",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)['\\\"]?\\s*OR\\s*['\\\"]?X['\\\"]?\\s*=\\s*['\\\"]?X['\\\"]?\\s*(?:--|#|/\\*|$)",
    "use_aho": false,
    "message": "SQL tautology detected (\"x\" = \"x\" style)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_admin_bypass_001",
    "group_id": "SQLI_AUTH_BYPASS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\bADMIN\\b\\s*(?:['\\\"])?\\s*OR\\s*(?:1\\s*=\\s*1|['\\\"]?1['\\\"]?\\s*=\\s*['\\\"]?1['\\\"]?)\\s*(?:--|#|/\\*|$)|\\bADMIN\\b\\s*['\\\"]?\\s*OR\\s*1=1",
    "use_aho": false,
    "message": "Authentication bypass attempt (admin OR 1=1 variants)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_parentheses_tautology_001",
    "group_id": "SQLI_COMPLEX",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\)\\s*OR\\s*\\(.*?\\)\\s*=\\s*\\(.*?\\)\\s*(?:--|#|/\\*|$)",
    "use_aho": false,
    "message": "Parentheses-style SQL tautology or nested comparison detected",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_or_true_comment_001",
    "group_id": "SQLI_COMMENT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:['\\\"]?\\s*OR\\s*TRUE\\s*(?:--|#|/\\*)|OR\\s*TRUE\\s*(?:--|#|/\\*)?)",
    "use_aho": false,
    "message": "OR TRUE with SQL comment terminator detected (possible injection)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_union_select_001",
    "group_id": "SQLI_UNION",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\bUNION\\b\\s+(?:ALL\\s+)?\\bSELECT\\b",
    "use_aho": false,
    "message": "UNION SELECT pattern detected (possible SQL injection / data exfiltration)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_comment_trailer_001",
    "group_id": "SQLI_COMMENT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?s)(?:--|#|/\\*)\\s*$",
    "use_aho": false,
    "message": "SQL-style comment trailer detected at end of input (possible SQLi payload)",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_weird_1e_001",
    "group_id": "SQLI_OBSCURE",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)1\\.e\\(1\\)|1e\\(1\\)",
    "use_aho": false,
    "message": "Unusual numeric/expression pattern (e.g. 1.e(1)) often used in obfuscated injections",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_quotes_or_space_variants_001",
    "group_id": "SQLI_QUOTE_VARIANTS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:['\\\"]?\\s*OR\\s*['\\\"]?['\\\"]?-|['\\\"]?\\s*OR\\s*['\\\"]?\\s*|['\\\"]?\\s*OR\\s*['\\\"]?&|['\\\"]?\\s*OR\\s*['\\\"]?\\^|['\\\"]?\\s*OR\\s*['\\\"]?\\*)",
    "use_aho": false,
    "message": "Quote + OR + single-symbol variants detected (common fuzzing/injection payloads)",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_login_hash_union_001",
    "group_id": "SQLI_UNION_HASH",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\bAND\\b\\s*1\\s*=\\s*0\\s*UNION\\s+ALL\\s+SELECT\\b|UNION\\s+ALL\\s+SELECT\\s+['\\\"]?admin['\\\"]?",
    "use_aho": false,
    "message": "UNION ALL SELECT with credential-like content detected",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "adv_tauto_or_and_001",
    "group_id": "SQLI_TAUTOLOGY_ADV",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:\\b(?:or|and)\\b)\\s*\\(?\\s*(?:0\\s*=\\s*0|1\\s*=\\s*1|true)\\s*\\)?\\s*(?:--|#|/\\*|;|$|\\u2013|\\u2014)?",
    "use_aho": false,
    "message": "SQL tautology detected (OR/AND 1=1, 0=0, TRUE) possibly with comment/trailer",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "adv_emptystring_equals_001",
    "group_id": "SQLI_EMPTY_EQ",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:''\\s*=\\s*''|\"\"\\s*=\\s*\"\"|['\\u2019\"]\\s*or\\s*['\\u2019\"]\\s*=\\s*['\\u2019\"])",
    "use_aho": false,
    "message": "Empty-string equality or equivalent (''='' or \"\"=\"\") — common blind/fuzzing injection",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "adv_like_wildcard_001",
    "group_id": "SQLI_LIKE",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bLIKE\\b\\s*['\\\"]%['\\\"]",
    "use_aho": false,
    "message": "LIKE '%' pattern detected — common SQLi / wildcard checks",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "adv_groupby_having_001",
    "group_id": "SQLI_GROUPBY_HAVING",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bGROUP\\s+BY\\b[\\s\\S]{0,200}?\\bHAVING\\b[\\s\\S]{0,50}?\\b(?:1\\s*=\\s*1|0\\s*=\\s*0)\\b",
    "use_aho": false,
    "message": "GROUP BY ... HAVING tautology pattern (attempt to manipulate aggregation/having clauses)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "adv_union_info_001",
    "group_id": "SQLI_UNION_ADV",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bUNION\\b(?:\\s+ALL)?\\s+\\bSELECT\\b|\\b@@version\\b|\\bsystem_user\\s*\\(|\\binformation_schema\\b",
    "use_aho": false,
    "message": "UNION SELECT or information-disclosure functions detected (UNION ALL SELECT, @@version, system_user(), information_schema...)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "adv_substring_enum_001",
    "group_id": "SQLI_ENUMERATE",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b(?:substring|substr|mid)\\s*\\(\\s*[^\\)\\r\\n]{1,80}\\s*\\)",
    "use_aho": false,
    "message": "Substring/substring-like function usage detected — may be used in blind extraction",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "adv_comment_trailer_any_001",
    "group_id": "SQLI_COMMENT_EXT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:--|#|/\\*|;|\\u2013|\\u2014)\\s*$",
    "use_aho": false,
    "message": "SQL comment/trailer at end of payload detected (--, #, /*, ;, en-dash variants) — common in injection payloads",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "adv_quoted_tauto_variants_001",
    "group_id": "SQLI_QUOTED_VARIANTS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:['\"\\u2019`])\\s*(?:or|OR|Or)\\s*(?:['\"\\u2019`])?\\s*(?:1\\s*=\\s*1|0\\s*=\\s*0|['\"\\u2019`]?\\s*1\\s*['\"\\u2019`]?\\s*=\\s*['\"\\u2019`]?\\s*1['\"\\u2019`]?)",
    "use_aho": false,
    "message": "Quoted tautology variants (handles smart quotes and backticks)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "adv_misc_obscure_001",
    "group_id": "SQLI_MISC",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b(or|and)\\b\\s*1\\s*=\\s*1\\s*[;#\\-\\u2013\\u2014]|\\b(or|and)\\b\\s*1\\s*=\\s*1\\b|\\b'\\s*or\\s*'1'\\s*=\\s*'1'\\b|\\b\"\\s*or\\s*\"1\"\\s*=\\s*\"1\"\\b",
    "use_aho": false,
    "message": "Misc common obfuscated tautologies and comment-trailer combos",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "timebased_waitfor_delay_001",
    "group_id": "SQLI_TIMEBASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)[\\)\\s'\"`\\u2019]{0,20}\\bWAITFOR\\b\\s+\\bDELAY\\b\\s*'[^']{1,64}'\\s*(?:--|#|/\\*|;|$|\\u2013|\\u2014)?",
    "use_aho": false,
    "message": "Time-based SQLi detected: WAITFOR DELAY '...' (handles leading parentheses/quotes and trailing comments)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "timebased_waitfor_delay_parenthesis_002",
    "group_id": "SQLI_TIMEBASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:[\\)\\]\\}]{1,30})?\\s*['\"`\\u2019]?\\s*(?:\\)?\\s*){0,10}\\bWAITFOR\\b\\s+\\bDELAY\\b\\s*'[^']{1,64}'",
    "use_aho": false,
    "message": "Waitfor-delay with many closing parentheses/quotes before payload (obfuscated variants)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "timebased_generic_sleep_003",
    "group_id": "SQLI_TIMEBASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:SLEEP|PG_SLEEP|PG_SLEEP|BENCHMARK|WAITFOR)\\b\\s*\\(?.{0,60}?\\)?\\s*(?:--|#|/\\*|;|$|\\u2013|\\u2014)?",
    "use_aho": false,
    "message": "Generic time-based function detected (SLEEP / pg_sleep / BENCHMARK / WAITFOR) — possible time-based SQLi",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "timebased_numeric_delay_004",
    "group_id": "SQLI_TIMEBASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "--------------------------BpNC6YYtaU9ekfpDg9OKZu\r\nContent-Disposition: attachment; name=\"use_aho\"\r\n\r\nfalse\r\n--------------------------BpNC6YYtaU9ekfpDg9OKZu\r\nContent-Disposition: attachment; name=\"action\"\r\n\r\nalert\r\n--------------------------BpNC6YYtaU9ekfpDg9OKZu--\r\n",
    "use_aho": false,
    "message": "WAITFOR/TIME keyword presence — additional detection",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "exec_xp_cmdshell_001",
    "group_id": "SQLI_DANGEROUS_CMDS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:exec(?:ute)?\\s+|;\\s*)?(?:master\\.){0,2}xp_cmdshell\\b\\s*\\(?",
    "use_aho": false,
    "message": "Exec/xp_cmdshell attempt detected (remote command execution).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "create_user_drop_table_002",
    "group_id": "SQLI_ADMIN_DDL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:CREATE\\s+USER|CREATE\\s+ROLE|DROP\\s+TABLE|ALTER\\s+USER|CREATE\\s+DATABASE)\\b",
    "use_aho": false,
    "message": "DDL or user-management SQL detected (CREATE USER / DROP TABLE / ALTER USER / CREATE DATABASE).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sp_addlogin_srvrole_003",
    "group_id": "SQLI_STORED_PROCS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\b(?:sp_addlogin|sp_addsrvrolemember|sp_addrolemember|xp_reg|sp_executesql)\\b",
    "use_aho": false,
    "message": "Potential privileged stored-proc usage detected (sp_addlogin, sp_addsrvrolemember, sp_executesql...).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "insert_into_mysql_user_password_004",
    "group_id": "SQLI_CREDENTIALS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\binsert\\s+into\\s+mysql\\.user\\b|\\bpassword\\s*\\(",
    "use_aho": false,
    "message": "Attempt to insert into mysql.user or call password() — possible credential creation/exfiltration.",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "grant_connect_resource_005",
    "group_id": "SQLI_PRIV_ESC",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\bGRANT\\b\\s+(?:CONNECT|RESOURCE|DBA|ALL)\\b",
    "use_aho": false,
    "message": "Granting privileges detected (GRANT CONNECT/RESOURCE/DBA/ALL).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "char_hex_concat_006",
    "group_id": "SQLI_OBFUSCATION",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\bCHAR\\s*\\(\\s*0x[0-9A-Fa-f]{1,}\\s*\\)|0x[0-9A-Fa-f]{2,})(?:\\s*\\+\\s*|\\s*\\||\\s*,\\s*)?(?:\\bCHAR\\s*\\(|0x[0-9A-Fa-f]{2,})",
    "use_aho": false,
    "message": "Hex literal or CHAR(0x...) usage detected — possible obfuscated payload (char(0x70)+...).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "union_parenthesis_select_007",
    "group_id": "SQLI_UNION_ADV",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\bUNION\\b(?:\\s+ALL)?\\s*(?:\\(\\s*)?\\bSELECT\\b|\\(\\s*SELECT\\b",
    "use_aho": false,
    "message": "UNION (SELECT ...) pattern detected (handles parentheses between UNION and SELECT).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "ms_sqli_version_generic_001",
    "group_id": "SQLI_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bSELECT\\b[\\s\\+\\(\\)\\\"\\']{0,20}(@@\\w{4,20})\\b",
    "use_aho": false,
    "message": "Information-disclosure variable detected (SELECT @@variable) — possible SQLi fingerprinting (@@version, @@servername, ...).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "ms_sqli_master_sys_002",
    "group_id": "SQLI_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bSELECT\\b[\\s\\+\\*\\,\\(\\)\\'\"\\w]{0,120}\\bFROM\\b[\\s\\+\\(\\)\\'\"]{0,10}(?:master\\.{1,2}\\w+|sys\\w{3,40})\\b",
    "use_aho": false,
    "message": "Access to master/sys tables detected (master..*, sysusers, sysservers, etc.) — possible info disclosure.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "ms_exec_xp_cmdshell_plus_003",
    "group_id": "SQLI_DANGEROUS_CMDS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b(?:exec|execute)\\b(?:\\s|\\+){0,6}(?:master\\.){0,2}xp_cmdshell\\b[\\s\\+\\(\\)'\"]{0,20}([a-z0-9_\\-\\.\\+]{2,200})",
    "use_aho": false,
    "message": "xp_cmdshell execution attempt detected (handles + as space and quoted command).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "ms_backup_to_disk_unc_004",
    "group_id": "SQLI_FILE_OPS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bBACKUP\\b(?:\\s|\\+)+\\bDATABASE\\b[\\s\\+\\w'`\\.\\-]{0,60}\\bTO\\b[\\s\\+\\=']{0,10}\\s*'\\\\\\\\[^'\\s]{3,300}'",
    "use_aho": false,
    "message": "BACKUP DATABASE to UNC path detected (possible data exfiltration to remote share).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "ms_bulk_insert_and_local_path_005",
    "group_id": "SQLI_FILE_OPS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bBULK(?:\\s|\\+)+INSERT\\b|\\bbulk(?:\\s|\\+)+insert\\b|\\bFROM\\b[\\s\\+]*'?[a-zA-Z]:(?:\\\\|%5C|\\\\\\\\)[^']+'",
    "use_aho": false,
    "message": "BULK INSERT or local file path (C:\\...) detected — possible file write/read or LFI via SQL.",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "ms_unc_or_smb_share_006",
    "group_id": "SQLI_FILE_OPS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\\\\\\\[A-Za-z0-9\\-_.%]{1,100}\\\\[A-Za-z0-9\\-_.%]{1,100}",
    "use_aho": false,
    "message": "UNC/SMB share path detected (\\\\host\\share) — possible exfiltration target.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "ms_common_command_exec_names_007",
    "group_id": "SQLI_DANGEROUS_CMDS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)xp_cmdshell[\\s\\+\\(\\)'\"]{0,10}(?:.*?\\b(?:ipconfig|net\\b|ping|whoami|dir|nc|netstat|tasklist)\\b)",
    "use_aho": false,
    "message": "Common OS command after xp_cmdshell detected (ipconfig/net/ping/...).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_digit_quote_digit_001",
    "group_id": "SQLI_QUOTE_ANOMALY",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b\\d{1,8}\\s*['\\u2019\"`]\\s*\\d{1,8}\\b",
    "use_aho": false,
    "message": "Suspicious digit-quote-digit pattern detected (possible malformed quote injection like 1'1).",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_exec_sp_xp_generic_002",
    "group_id": "SQLI_STORED_PROCS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b(?:exec|execute)\\b[\\s\\+\\(\\)\\'\"`]{0,8}\\b(?:sp_[a-z0-9_]+|xp_[a-z0-9_]+)\\b",
    "use_aho": false,
    "message": "Execution of stored-proc pattern detected (exec sp_* or exec xp_*) — possible privilege escalation or command exec.",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_subselect_comparison_003",
    "group_id": "SQLI_SUBSELECT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b=\\s*\\(\\s*SELECT\\b|\\b1\\s*=\\s*\\(\\s*SELECT\\b|\\b=\\s*\\(\\s*select\\b",
    "use_aho": false,
    "message": "Comparison to subselect detected (e.g. 1 = (SELECT ...)) — potential blind or advanced SQLi.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "timebased_benchmark_decoded_001",
    "group_id": "SQLI_TIMEBASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)[\\)\\s'\"`\\u2019]{0,30}\\b0\\s*=\\s*BENCHMARK\\s*\\(\\s*\\d{1,9}\\s*,\\s*MD5\\s*\\(\\s*\\d+\\s*\\)\\s*\\)\\s*(?:--|#|/\\*|;|$|\\u2013|\\u2014)?",
    "use_aho": false,
    "message": "Time-based MySQL BENCHMARK() detected (decoded form) — possible time-based SQLi.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "timebased_benchmark_encoded_002",
    "group_id": "SQLI_TIMEBASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)[\\)\\s'\"`\\u2019%]{0,60}0(?:%20|\\+|\\s)*=(?:%20|\\+|\\s)*BENCHMARK%20*\\(%20*\\d{1,9}%20*,%20*MD5%28%20*\\d+%20*%29%20*%29(?:%20)*(?:%2D%2D|%23|%2F\\*|--|#|/\\*)?",
    "use_aho": false,
    "message": "Time-based MySQL BENCHMARK() detected (URL-encoded form, handles %20, %2D%2D, %23, %2F*).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "timebased_benchmark_generic_003",
    "group_id": "SQLI_TIMEBASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b(0\\s*=\\s*BENCHMARK|BENCHMARK\\s*\\()|\\bbenchmark\\s*\\(",
    "use_aho": false,
    "message": "Generic BENCHMARK keyword detected (catch other benchmark(...) variants).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "http-dothtaccess-cmd-001",
    "group_id": "WEB-HTTP",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "GET\\s+/.htaccess\\?.*",
    "use_aho": false,
    "message": "Possible remote command attempt: .htaccess?cmd=... in HTTP request",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "mysql_load_data_infile_decoded_001",
    "group_id": "SQLI_FILE_OPS_MYSQL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)[\\)\\s'\"`\\u2019]{0,30}\\bLOAD\\b(?:\\s|\\+){0,6}(?:DATA)\\b(?:\\s|\\+){0,6}(?:LOCAL\\b(?:\\s|\\+){0,6})?\\bINFILE\\b[\\s\\+\\(\\)'\"]{0,60}",
    "use_aho": false,
    "message": "MySQL LOAD DATA INFILE / LOAD DATA LOCAL INFILE detected (possible local file read via SQLi).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "mysql_load_data_infile_encoded_002",
    "group_id": "SQLI_FILE_OPS_MYSQL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)[\\)\\s'\"`\\u2019%+]{0,80}LOAD(?:%20|\\+|\\s)*DATA(?:%20|\\+|\\s)*(?:LOCAL(?:%20|\\+|\\s)*)?INFILE(?:%20|\\+|\\s)*['%22%27%28]?.{1,400}['%22%27%29]?(?:%20)*(?:%2D%2D|%23|%2F\\*|--|#|/\\*)?",
    "use_aho": false,
    "message": "URL-encoded MySQL LOAD DATA INFILE pattern detected (handles %20, %2D%2D, %23, %2F*).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "mysql_load_file_func_003",
    "group_id": "SQLI_FILE_OPS_MYSQL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bLOAD_FILE\\s*\\(\\s*['\"]?([^'\"\\)\\r\\n]{1,400})['\"]?\\s*\\)",
    "use_aho": false,
    "message": "MySQL LOAD_FILE() detected (possible local file read / disclosure).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "mysql_into_outfile_dumpfile_004",
    "group_id": "SQLI_FILE_OPS_MYSQL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bINTO\\b(?:\\s|\\+){0,6}\\b(?:OUTFILE|DUMPFILE)\\b[\\s\\+\\=\\'\\\"]{0,60}['\"]?[^'\"\\s]{1,400}['\"]?",
    "use_aho": false,
    "message": "INTO OUTFILE or INTO DUMPFILE detected (possible file write/exfiltration to local path).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "file_path_unix_windows_005",
    "group_id": "SQLI_FILE_PATHS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:[a-zA-Z]:\\\\[^\\s'\"<>]{3,400}|/etc/\\w{1,200}|/proc/\\w{1,200}|/var/\\w{1,200}|\\.\\./\\.\\./[^\\s'\"<>]{1,300})",
    "use_aho": false,
    "message": "Absolute or relative local file path detected (C:\\..., /etc/..., ../.. ) — possible local-file disclosure attempt.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "mysql_select_from_myfile_006",
    "group_id": "SQLI_FILE_OPS_MYSQL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bSELECT\\b[\\s\\+\\*\\,\\(\\)\\'\"\\w]{0,120}\\bFROM\\b[\\s\\+\\(\\)\\'\"\\w]{0,20}\\bmyfile\\b",
    "use_aho": false,
    "message": "SELECT from temporary/myfile table pattern detected — common pattern after LOAD DATA INFILE.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "oracle_utl_http_001",
    "group_id": "SQLI_ORACLE_EXFIL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\|\\|\\s*UTL_HTTP\\.REQUEST\\s*\\(|\\bUTL_HTTP\\.REQUEST\\s*\\(",
    "use_aho": false,
    "message": "Possible Oracle HTTP exfiltration via UTL_HTTP.REQUEST (string concat or direct call).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "oracle_utl_inaddr_002",
    "group_id": "SQLI_ORACLE_EXFIL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bUTL_INADDR\\.GET_HOST_ADDRESS\\s*\\(",
    "use_aho": false,
    "message": "Possible Oracle DNS/host exfiltration via UTL_INADDR.GET_HOST_ADDRESS.",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "oracle_v$_and_sys_003",
    "group_id": "SQLI_ORACLE_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bV\\$[A-Za-z0-9_]{3,50}\\b|\\bGLOBAL_NAME\\b|\\bSYS\\.LOGIN_USER\\b|\\bSYS\\.DATABASE_NAME\\b|\\bV\\$VERSION\\b",
    "use_aho": false,
    "message": "Access to Oracle V$ or SYS metadata detected (v$version, v$instance, global_name, SYS.LOGIN_USER...).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "oracle_distinct_rownum_limit_004",
    "group_id": "SQLI_ORACLE_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bSELECT\\b[\\s\\S]{0,400}?\\bDISTINCT\\b[\\s\\S]{0,200}?\\bROWNUM\\b|\\bROWNUM\\b\\s*AS\\s*LIMIT\\b|\\bROWNUM\\b",
    "use_aho": false,
    "message": "Subselects with DISTINCT/ROWNUM patterns detected — possible blind enumeration via ROWNUM paging.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "oracle_string_concat_func_005",
    "group_id": "SQLI_ORACLE_EXFIL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\|\\|\\s*(?:[A-Za-z0-9_]+\\s*\\(|[A-Za-z0-9_]+\\b)",
    "use_aho": false,
    "message": "String-concatenation with function call detected (|| func(...) ||) — possible outbound call construction (HTTP/DNS).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "oracle_proc_custom_006",
    "group_id": "SQLI_ORACLE_PROCS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\|\\|\\s*MYAPPADMIN\\.ADDUSER\\s*\\(|\\bMYAPPADMIN\\.ADDUSER\\s*\\(|\\bMYAPPADMIN\\.\\w+\\s*\\(",
    "use_aho": false,
    "message": "Call to application stored-proc detected in injection (e.g. myappadmin.adduser).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "oracle_url_in_payload_007",
    "group_id": "SQLI_EXFIL_URL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)https?://[0-9A-Za-z\\-\\._:@%\\$\\+~#=\\/?&]{5,400}|\\\\\\\\[0-9]{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\\\",
    "use_aho": false,
    "message": "Outbound URL or IP-based UNC path found inside SQL payload — possible exfiltration destination.",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "pg_func_version_001",
    "group_id": "SQLI_PG_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bSELECT\\b[\\s\\+\\(\\)\\'\"`]{0,20}\\bVERSION\\s*\\(\\s*\\)\\b",
    "use_aho": false,
    "message": "Postgres version() detected — possible info disclosure attempt.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "pg_current_db_user_002",
    "group_id": "SQLI_PG_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bSELECT\\b[\\s\\+\\(\\)\\'\"`]{0,20}\\b(?:CURRENT_DATABASE|CURRENT_USER|SESSION_USER)\\s*\\(?",
    "use_aho": false,
    "message": "Postgres current_database/current_user/session_user detected — possible info disclosure.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "pg_current_setting_003",
    "group_id": "SQLI_PG_CONFIG",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bCURRENT_SETTING\\s*\\(\\s*['\"]?(?:log_connections|log_statement|port|password_encryption|krb_server_keyfile|virtual_host|config_file|hba_file|data_directory|\\w{3,80})['\"]?\\s*\\)",
    "use_aho": false,
    "message": "Postgres current_setting(...) detected (sensitive server config exposed).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "pg_sys_tables_004",
    "group_id": "SQLI_PG_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bSELECT\\b[\\s\\S]{0,200}?\\bFROM\\b[\\s\\+\\(\\)\\'\"`]{0,10}\\b(?:PG_SHADOW|PG_GROUP|PG_AUTHID|PG_USER|PG_CLASS|PG_CATALOG|PG_ROLE|PG_DATABASE)\\b",
    "use_aho": false,
    "message": "Access to PostgreSQL system tables detected (pg_shadow/pg_group/pg_*).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "pg_copy_file_ops_005",
    "group_id": "SQLI_PG_FILEOPS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bCOPY\\b(?:\\s|\\+){0,6}[A-Za-z0-9_\\.\\\"]{0,80}(?:\\s|\\+){0,6}\\b(?:FROM|TO)\\b(?:\\s|\\+){0,6}['\"]?(?:/etc/|/var/|/tmp/|[A-Za-z]:\\\\|/root/|\\.{2}/)[^'\"\\s]{1,400}['\"]?",
    "use_aho": false,
    "message": "Postgres COPY ... FROM/TO local file path detected (possible file disclosure/exfiltration).",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "pg_select_from_myfile_006",
    "group_id": "SQLI_PG_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\bSELECT\\b[\\s\\+\\*\\,\\(\\)\\'\"\\w]{0,120}\\bFROM\\b[\\s\\+\\(\\)\\'\"\\w]{0,20}\\bMYFILE\\b",
    "use_aho": false,
    "message": "SELECT from temporary/myfile table detected — common pattern after COPY from file.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "pg_ddl_generic_007",
    "group_id": "SQLI_DDL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b(CREATE\\s+TABLE|ALTER\\s+TABLE|DROP\\s+TABLE|CREATE\\s+DATABASE)\\b",
    "use_aho": false,
    "message": "DDL statement detected (CREATE/ALTER/DROP) — may indicate injection attempting schema changes.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "pg_file_path_generic_008",
    "group_id": "SQLI_FILE_PATHS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:/etc/[^\\s'\";]{3,300}|/var/[^\\s'\";]{3,300}|/tmp/[^\\s'\";]{1,200}|[A-Za-z]:\\\\[^\\s'\";]{3,300}|\\.\\./\\.\\./[^\\s'\";]{1,300})",
    "use_aho": false,
    "message": "Absolute/relative file path detected (UNIX/Windows) — possible local file read/write via SQL.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "pg_generic_function_009",
    "group_id": "SQLI_PG_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b(\\w+_?file|pg_read_file|pg_ls_dir|pg_stat_file|pg_file_read|pg_file_read_dir)\\s*\\(",
    "use_aho": false,
    "message": "Postgres file-related function detected (pg_read_file/pg_ls_dir/pg_stat_file) — possible local file disclosure.",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_boolean_001",
    "group_id": "SQLI_BOOLEAN",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:\\b(?:or|and)\\b\\s*\\d+\\s*[=><]\\s*\\d+|\\b(?:or|and)\\b\\s*'.*?'\\s*[=><]\\s*'.*?')",
    "use_aho": false,
    "message": "Boolean-based SQL Injection attempt detected (AND/OR 1=1 pattern).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_union_select_002",
    "group_id": "SQLI_UNION",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)union\\s+(?:all\\s+)?select\\s+(?:[\\w\\W]{1,300})",
    "use_aho": false,
    "message": "UNION SELECT SQL Injection attempt detected.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_comment_003",
    "group_id": "SQLI_COMMENTS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:--|#|/\\*.*?\\*/)(?:\\s*\\b(select|union|update|insert|delete)\\b)?",
    "use_aho": false,
    "message": "SQL comment-style injection pattern detected (--, #, /* */).",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_benchmark_004",
    "group_id": "SQLI_TIME_BASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)benchmark\\s*\\(\\s*\\d+\\s*,\\s*(?:md5|sha1|sha2|sleep)\\s*\\(",
    "use_aho": false,
    "message": "Time-based SQL Injection attempt using BENCHMARK() or delay functions.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_exec_cmdshell_005",
    "group_id": "SQLI_CMD_EXEC",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:exec\\s+master\\.\\.xp_cmdshell|sp_addlogin|sp_addsrvrolemember|xp_cmdshell)",
    "use_aho": false,
    "message": "Command execution attempt via MSSQL xp_cmdshell or stored procedures.",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_pg_info_006",
    "group_id": "SQLI_POSTGRES_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:select\\s+current_setting\\s*\\(|pg_shadow|pg_group|pg_user|version\\s*\\(\\))",
    "use_aho": false,
    "message": "PostgreSQL information disclosure attempt detected.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_mysql_info_007",
    "group_id": "SQLI_MYSQL_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:select\\s+@@(?:version|hostname|datadir|basedir|global\\.version)|load_file\\s*\\()",
    "use_aho": false,
    "message": "MySQL information disclosure or file read attempt detected.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_file_load_008",
    "group_id": "SQLI_FILE_PATHS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:load\\s+data\\s+infile\\s+['\"]?/[\\w\\-_/]+['\"]?|copy\\s+\\w+\\s+from\\s+['\"]?/[^'\"\\s]+)",
    "use_aho": false,
    "message": "Possible SQL file read/write via LOAD DATA or COPY FROM statement.",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_orderby_009",
    "group_id": "SQLI_ORDERBY_ENUM",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)order\\s+by\\s+[0-9]{1,5}(?:--|#|\\s|$)",
    "use_aho": false,
    "message": "SQL Injection ORDER BY column enumeration detected.",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_if_case_010",
    "group_id": "SQLI_CONDITIONAL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:if\\s*\\([^\\)]+\\)\\s*select|case\\s+when\\s+\\d+\\s*=\\s*\\d+)",
    "use_aho": false,
    "message": "Conditional IF/CASE SQLi pattern detected.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_rlike_011",
    "group_id": "SQLI_REGEX_TEST",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)rlike\\s*\\(\\s*select\\s*\\(",
    "use_aho": false,
    "message": "MySQL RLIKE subselect SQL Injection detected.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_wildcard_012",
    "group_id": "SQLI_WILDCARD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)%['\"]?\\s*(?:and|or)\\s*\\d+\\s*=\\s*\\d+",
    "use_aho": false,
    "message": "Wildcard-based SQLi attempt using '%' and boolean logic.",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_short_token_quote_013",
    "group_id": "SQLI_QUOTE_ANOMALY",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\b\\d{1,6}\\s*(?:['\"`\\\\]|\\[|\\])",
    "use_aho": false,
    "message": "Suspicious short numeric token followed by quote/backtick/backslash/bracket (e.g. 1', 1\", 1`, 1\\, [1]) — possible injection fuzzing or malformed quote.",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_mysql_version_comment_014",
    "group_id": "SQLI_COMMENT_MYSQL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)/\\*!\\d{1,6}[^*]*\\*/",
    "use_aho": false,
    "message": "MySQL versioned comment pattern detected (/*! ... */) — often used for obfuscated payloads.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_concat_pipepipe_015",
    "group_id": "SQLI_CONCATENATION",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)'[^']*'\\s*\\|\\|\\s*'[^']*'|\\|\\|\\s*UTL_HTTP|\\|\\|\\s*MYAPPADMIN",
    "use_aho": false,
    "message": "String concatenation operator '||' detected in payload (quoted concatenation or concatenation with function calls) — possible Oracle/SQL injection exfiltration.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_empty_string_tautology_016",
    "group_id": "SQLI_TAUTOLOGY_QUOTED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:''\\s*=\\s*''|\"\"\\s*=\\s*\"\"|\\bor\\b\\s*''\\s*=\\s*''|\\bor\\b\\s*\"\"\\s*=\\s*\"\"|\\bor\\b\\s*''\\s*=\\s*'')",
    "use_aho": false,
    "message": "Empty-string equality or obfuscated quoted tautology detected (e.g. ''='' , \"\"=\"\" , or ''='').",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_bracket_index_017",
    "group_id": "SQLI_BRACKET_ENUM",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)\\[\\s*\\d{1,6}\\s*\\]",
    "use_aho": false,
    "message": "Bracketed numeric index detected (e.g. [1]) — often used in ORDER BY / column enumeration attacks on some DBs.",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli-order-sleep-001",
    "group_id": "SQLI_TIME_BASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)(order\\s+by\\s+[0-9,\\s]*s?leep\\s*\\(\\s*\\d+\\s*\\))",
    "use_aho": false,
    "message": "SQL Injection attempt: ORDER BY with SLEEP() time-based payload",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli-benchmark-md5-002",
    "group_id": "SQLI_TIME_BASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)(s?leep\\s*\\(\\s*\\d+\\s*\\)|benchmark\\s*\\(\\s*\\d+\\s*,\\s*md5\\s*\\(.*?\\)\\s*\\))",
    "use_aho": false,
    "message": "SQL Injection attempt: Time delay using SLEEP() or BENCHMARK()",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli-union-select-003",
    "group_id": "SQLI_UNION_BASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)(union\\s+all\\s+select\\s+([0-9]+\\s*,\\s*)*[0-9]+)",
    "use_aho": false,
    "message": "SQL Injection attempt: UNION ALL SELECT enumeration",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli-union-select-comment-004",
    "group_id": "SQLI_UNION_BASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)(union\\s+all\\s+select[\\s0-9,]*?(--|#))",
    "use_aho": false,
    "message": "SQL Injection attempt: UNION ALL SELECT with SQL comment",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli-order-sleep-comment-005",
    "group_id": "SQLI_TIME_BASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?i)(order\\s+by\\s+[0-9,\\s]*s?leep\\s*\\(\\s*\\d+\\s*\\)\\s*(--|#)?)",
    "use_aho": false,
    "message": "SQL Injection attempt: ORDER BY with SLEEP() and comment",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_sleep_func_013",
    "group_id": "SQLI_TIME_BASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(sleep\\s*\\(\\s*\\d+\\s*\\))",
    "use_aho": false,
    "message": "Time-based SQL Injection attempt using SLEEP() function.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_waitfor_delay_014",
    "group_id": "SQLI_TIME_BASED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)waitfor\\s+delay\\s+'\\d+:\\d+:\\d+'",
    "use_aho": false,
    "message": "Time-based SQL Injection attempt using WAITFOR DELAY (MSSQL).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_subselect_015",
    "group_id": "SQLI_BOOLEAN_SUBSELECT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(and|or)\\s*\\(\\s*select\\s+.+?\\)\\s*[=><]\\s*\\d+",
    "use_aho": false,
    "message": "Boolean-based SQL Injection using sub-select expression.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_groupby_016",
    "group_id": "SQLI_GROUPBY_ENUM",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)group\\s+by\\s+[0-9,\\s]+(--|#|$)",
    "use_aho": false,
    "message": "SQL Injection GROUP BY column enumeration detected.",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_waitfor_013",
    "group_id": "SQLI_TIME_BASED_MSSQL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)waitfor\\s+delay\\s*'\\s*\\d{1,2}:\\d{1,2}:\\d{1,2}\\s*'",
    "use_aho": false,
    "message": "MS-SQL Time-based SQLi attempt using WAITFOR DELAY.",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_sleep_014",
    "group_id": "SQLI_TIME_BASED_MYSQL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)sleep\\s*\\(\\s*\\d+\\s*\\)",
    "use_aho": false,
    "message": "MySQL Time-based SQLi using SLEEP().",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_encoded_time_015",
    "group_id": "SQLI_TIME_BASED_ENCODED",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(%20|\\+)?waitfor(%20|\\+)+delay(%20|\\+)*'|%20sleep%20|%20benchmark%20",
    "use_aho": false,
    "message": "URL-encoded time-based SQLi attempt detected (e.g. %20waitfor%20delay%20, %20sleep%20).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_groupby_016",
    "group_id": "SQLI_GROUPBY_ENUM",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)group\\s+by\\s+[0-9,\\s]+(?:--|#|/\\*|\\s|$)",
    "use_aho": false,
    "message": "SQL Injection GROUP BY column enumeration detected.",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "sqli_subselect_boolean_017",
    "group_id": "SQLI_SUBSELECT_BOOLEAN",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?isu)(?:and|or)\\s*\\(\\s*select\\s+[^\\)]+\\)\\s*[=><]",
    "use_aho": false,
    "message": "Boolean/subselect SQLi pattern detected (AND/OR (SELECT ...) = ...).",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "http-dothtaccess-encoded-cmd-002",
    "group_id": "WEB-HTTP",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+[^\\s]*(?:\\.|%2e)htaccess(?:\\?[^\\r\\n]*\\bcmd\\b\\s*=\\s*[^\\s&]+)",
    "use_aho": false,
    "message": "Possible remote command attempt via encoded .htaccess (cmd param)",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "c5d6e1f2-8a1b-11ef-9cba-0242ac120002",
    "group_id": "DNS",
    "proto": "UDP",
    "dst_port": 53,
    "pattern_regex_bytes": "(?is)\\x00.*(example\\.com|google\\.com|localhost)",
    "use_aho": false,
    "message": "DNS traffic detected",
    "severity": "low",
    "action": "log",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "d7e8f304-8a1b-11ef-9cba-0242ac120002",
    "group_id": "SHELLCODE",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_hex": "90eb",
    "use_aho": true,
    "message": "Possible shellcode NOP/JMP pattern",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_regex_bytes": null
  },
  {
    "uuid": "fa012328-8a1b-11ef-9cba-0242ac120002",
    "group_id": "CRED_LEAK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(password\\s*=|passwd\\s*=|pwd\\s*=)",
    "use_aho": false,
    "message": "Possible credential leakage in payload",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "aa123456-8a1b-11ef-9cba-0242ac120002",
    "group_id": "COMMAND_INJECTION",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(;\\s*(ls|cat|whoami|nc|bash)|`.*`)",
    "use_aho": false,
    "message": "Possible command injection attempt",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "bb234567-8a1b-11ef-9cba-0242ac120002",
    "group_id": "XSS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(<script.*?>|javascript:|onerror=|onload=)",
    "use_aho": false,
    "message": "Possible cross-site scripting (XSS) attempt",
    "severity": "medium",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "cc345678-8a1b-11ef-9cba-0242ac120002",
    "group_id": "FTP_CRED",
    "proto": "TCP",
    "dst_port": 21,
    "pattern_regex_bytes": "(?is)(USER\\s+\\w+|PASS\\s+\\w+)",
    "use_aho": false,
    "message": "FTP credentials detected",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "dd456789-8a1b-11ef-9cba-0242ac120002",
    "group_id": "TELNET",
    "proto": "TCP",
    "dst_port": 23,
    "pattern_regex_bytes": "(?is)(login:|password:)",
    "use_aho": false,
    "message": "Telnet login attempt detected",
    "severity": "medium",
    "action": "log",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "f1a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\b/etc/passwd\\b|\\betc[\\/%5c\\\\]+passwd\\b|%2fetc%2fpasswd|etc%252fpasswd)",
    "use_aho": false,
    "message": "Possible LFI probe - /etc/passwd variants detected",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "f2a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_TRAVERSAL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:((?:\\.\\./|%2e%2e%2f|%2e%2e|%252e%252e%252f){2,})|(?:%c0%af)|(?:%5c)|(?:%5c%5c))",
    "use_aho": false,
    "message": "Directory traversal pattern detected (../ / encoded / overlong)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "f3a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_NULLBYTE",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(%00|\\x00|%2500)\\b",
    "use_aho": false,
    "message": "Null byte (%00) in URI/param — possible LFI/null-byte poisoning",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "f4a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_WINDOWS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:c:\\\\boot\\.ini|windows[\\\\/](?:win\\.ini|system32)|c%3a%5cboot\\.ini|c%3a%2fboot\\.ini)",
    "use_aho": false,
    "message": "Possible Windows file-read probe (boot.ini / win.ini)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "f5a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_HTTPD_LOGS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:httpd\\.conf|httpd2\\.conf|access_log|error_log|http\\-access\\.log|http\\-error\\.log|apache2[\\\\/].*httpd\\.conf)",
    "use_aho": false,
    "message": "Probe for webserver config/log files (httpd.conf / access_log / error_log)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "f6a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_ENCODING_EVASION",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:%c0%af|%c1%1c|%c1%9c|%ef%bc%8f|%252f){1,}",
    "use_aho": false,
    "message": "Encoded/overlong UTF-8 or double-encoded slash sequences — possible evasion for LFI",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "f7a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_MULTITRY",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\b(passwd|boot\\.ini|httpd\\.conf|access_log|error_log)\\b).*(?:%00|%2f|%5c|%c0%af)",
    "use_aho": false,
    "message": "File-read probe combining common filenames with encoding/NULL — high confidence",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "f8a2b3c4-9a1b-11ef-9cba-0242ac120002",
    "group_id": "LFI_RATE",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:/\\.\\./|%2e%2e%2f|%252e%252e%252f)",
    "use_aho": false,
    "message": "Repeated traversal attempts detected — suggest rate-limit or block IP",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "lfi_media_001",
    "group_id": "MEDIA_EXPLOIT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(RIFF.*AVI|#EXTM3U|#EXT-X-|00tx|00dc|/etc/|\\\\\\\\[0-9]{1,3})",
    "use_aho": false,
    "message": "Possible malicious media upload (playlist/embed references local paths or EXTM3U)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "lfi_media_002",
    "group_id": "MEDIA_EXPLOIT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(<\\?php|<script|<iframe|<img|onerror=|onload=)",
    "use_aho": false,
    "message": "Possible malicious media upload (media file contains embedded script tags or PHP)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "m1a2b3c4-media-exploit-001",
    "group_id": "MEDIA_EXPLOIT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(RIFF.*AVI|#EXTM3U|#EXT-X-BYTERANGE|#EXTINF:|00tx|00dc|XBIN|file://|/dev/zero|\\\\\\\\[0-9]{1,3})",
    "use_aho": false,
    "message": "Possible malicious media upload (embedded playlist/byte-range pointing to local/remote resource)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "m1a2b3c4-media-exploit-002",
    "group_id": "MEDIA_EXPLOIT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(<\\?php|<script|<iframe|<img|onerror=|onload=|eval\\(|system\\(|exec\\(|base64_decode\\()",
    "use_aho": false,
    "message": "Possible malicious media upload (media file contains embedded script tags or PHP code)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "ht-001",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+/.htaccess\\b.*\\?.*",
    "use_aho": false,
    "message": "Possible remote .htaccess web-shell access attempt",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "ht-002",
    "group_id": "UPLOAD_PHP_TAG",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?php|AddType\\s+application/x-httpd-php|Allow\\s+from\\s+all",
    "use_aho": false,
    "message": "Uploaded file contains PHP tag or dangerous Apache directives",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "message": "Potential Command Injection Detected (semicolon in parameter)",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "[?&][a-zA-Z0-9_]+=[^&]*;",
    "uuid": "b871c676-8949-4d25-b665-2cde15fd02e2",
    "group_id": "CMD-INJ-001",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "severity": "low",
    "action": "log"
  },
  {
    "message": "Potential Command Injection Detected (common commands in parameter)",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "[?&][a-zA-Z0-9_]+=[^&]*(whoami|ls|cat|wget|curl)",
    "uuid": "69ce2f3e-15c4-4e95-ae5f-f04da634819a",
    "group_id": "CMD-INJ-002",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "severity": "low",
    "action": "log"
  },
  {
    "message": "Potential Command Injection in POST Body",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "cmd=[^&]*;",
    "uuid": "5f39cffb-2347-4b0f-a868-547a496d8e44",
    "group_id": "CMD-INJ-003",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "severity": "low",
    "action": "log"
  },
  {
    "uuid": "htshell-001",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)AddType\\s+application/x-httpd-php\\s*\\.htaccess",
    "use_aho": false,
    "message": "Suspicious .htaccess mapping to PHP detected",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htshell-002",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?php.*?>",
    "use_aho": false,
    "message": "PHP code detected inside uploaded file",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htshell-003",
    "group_id": "SERVER_INFO",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)SetHandler\\s+server-(status|info)",
    "use_aho": false,
    "message": "Attempt to enable server-status/server-info via .htaccess",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htshell-004",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+/.htaccess\\b.*",
    "use_aho": false,
    "message": "Direct access attempt to .htaccess",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rce-addtype-001",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)AddType\\s+application/x-httpd-php\\s*\\.rce",
    "use_aho": false,
    "message": "Detected AddType mapping .rce to PHP (possible .htaccess web-shell)",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rce-upload-002",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\.(rce)\\b",
    "use_aho": false,
    "message": "Uploaded file with .rce extension detected",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rce-phpcode-003",
    "group_id": "UPLOAD_PHP_TAG",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?(php|=)",
    "use_aho": false,
    "message": "Uploaded content contains PHP tags",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "rce-access-004",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+\\S+\\.rce\\b",
    "use_aho": false,
    "message": "Direct access attempt to .rce file",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "http-dothtaccess-cmd-001",
    "group_id": "WEB-HTTP",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+[^\\s]*\\.htaccess\\?[^\\n\\r]*\\bcmd\\s*=\\s*[^\\s&]+",
    "use_aho": false,
    "message": "Remote command injection attempt via .htaccess (cmd parameter)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "http-sqli-union-001",
    "group_id": "WEB-SQLI",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\bUNION\\b\\s+\\bSELECT\\b|\\bSELECT\\b[^\\n\\r]{0,120}\\bFROM\\b[^\\n\\r]{0,120}\\bUNION\\b)",
    "use_aho": false,
    "message": "Possible SQL injection: UNION SELECT pattern detected in HTTP request",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "http-sqli-boolean-or-001",
    "group_id": "WEB-SQLI",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:\\b'or\\b|\\b\\\"or\\b)\\s+[^\\s]*=\\s*[^\\s]+|(?:--\\s*$|#\\s*$|/\\*.*\\*/)",
    "use_aho": false,
    "message": "Possible SQL injection: boolean OR / comment-based injection",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-001",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)AddType\\s+application/x-httpd-php\\s*\\.htaccess|AddType\\s+application/x-httpd-php\\s*\\.rce",
    "use_aho": false,
    "message": "Suspicious AddType mapping .htaccess/.rce to PHP detected",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-002",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?(php|=)",
    "use_aho": false,
    "message": "PHP code detected in uploaded content",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-003",
    "group_id": "WEB_SHELL",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Require\\s+all\\s+granted|Order\\s+allow,deny|Allow\\s+from\\s+all",
    "use_aho": false,
    "message": "Directive making .htaccess accessible detected",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-004",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+/.htaccess\\b.*",
    "use_aho": false,
    "message": "Direct access attempt to .htaccess",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-005",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)GET\\s+\\S+\\.rce\\b",
    "use_aho": false,
    "message": "Direct access attempt to .rce file",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-zip-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Content-Disposition:.*filename\\s*=\\s*[\\\"']?([^\\r\\n\\\"']*(?:\\.zip|\\.ZIP))[^\\r\\n\\\"']*[\\\"']?.*|(\\%2e\\%2e|\\.\\.)",
    "use_aho": false,
    "message": "Uploaded zip filename contains path traversal or encoded ../",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-zip-002",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?s)(?:PK\\\\x03\\\\x04).*?(?:\\.\\./|%2e%2e|/\\\\\\.\\\\.)",
    "use_aho": false,
    "message": "ZIP archive contains path traversal entries (PK header + ../ or encoded variants)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-zip-003",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)PK\\\\x03\\\\x04.*?\\.\\./[^\\r\\n]*__init__\\.py",
    "use_aho": false,
    "message": "ZIP contains ../.../__init__.py entry — possible python package trojanization",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-zip-004",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)PK\\\\x03\\\\x04.*?/([A-Za-z0-9_\\-]+/)*[A-Za-z0-9_\\-]+",
    "use_aho": false,
    "message": "ZIP archive contains absolute path entries (leading slash) — suspicious",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-upload-005",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Content-Disposition:.*filename\\s*=\\s*[^\\r\\n]*\\.(py|php|phtml|htaccess)\\b",
    "use_aho": false,
    "message": "Upload attempt contains potentially executable/config files (.py, .php, .htaccess)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "htb-path-enc-006",
    "group_id": "ACCESS",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)%2e%2e%2f|%2e%2e%5c",
    "use_aho": false,
    "message": "URL-encoded traversal sequence detected in request",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "uwsgi-exec-001",
    "group_id": "CONFIG",
    "pattern_regex_bytes": "(?is)@\\(\\s*exec://",
    "message": "uWSGI config executes system command (exec://)",
    "severity": "critical",
    "action": "alert",
    "proto": "ANY",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "dst_port": null
  },
  {
    "uuid": "uwsgi-http-002",
    "group_id": "CONFIG",
    "pattern_regex_bytes": "(?is)@\\(\\s*http://",
    "message": "uWSGI config loads remote content (http://)",
    "severity": "high",
    "action": "alert",
    "proto": "ANY",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "dst_port": null
  },
  {
    "uuid": "uwsgi-fd-003",
    "group_id": "CONFIG",
    "pattern_regex_bytes": "(?is)@\\(\\s*fd://",
    "message": "uWSGI config reads from file descriptor (fd://)",
    "severity": "medium",
    "action": "alert",
    "proto": "ANY",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "dst_port": null
  },
  {
    "uuid": "uwsgi-call-004",
    "group_id": "CONFIG",
    "pattern_regex_bytes": "(?is)@\\(\\s*call://",
    "message": "uWSGI config calls internal C function (call://)",
    "severity": "high",
    "action": "alert",
    "proto": "ANY",
    "pattern_bytes": null,
    "pattern_hex": null,
    "use_aho": false,
    "dst_port": null
  },
  {
    "uuid": "upload-xss-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\s*script\\b[^>]*>|javascript:\\s*|onerror\\s*=|onload\\s*=",
    "use_aho": false,
    "message": "Possible XSS payload in uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-xss-002",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Content-Type:\\s*(text/html|application/javascript)",
    "use_aho": false,
    "message": "Possible XSS payload in uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-xss-003",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)%3Cscript%3E|%3Ciframe|%3Cimg%20onerror",
    "use_aho": false,
    "message": "Possible XSS payload in uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)Content-Disposition:.*filename\\s*=\\s*[^\\r\\n]*\\.(php|phtml|php[3-8]|phar)\\b",
    "use_aho": false,
    "message": "Attempt to upload PHP executable file (possible webshell)",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-002",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?(php|=)|eval\\s*\\(|system\\s*\\(|shell_exec\\s*\\(|exec\\s*\\(",
    "use_aho": false,
    "message": "Possible PHP webshell code in uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-003",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<Files|AddType\\s+application/x-httpd-php|php_flag|php_value",
    "use_aho": false,
    "message": "Possible malicious .htaccess upload to enable PHP execution",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-004",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)filename\\s*=\\s*[^\\r\\n]*\\.(?:php\\d*|pht|phar|phpt|pgif|phtml|phtm|inc|jpe?g\\.php|png\\.php|php(?:%00|\\\\x00)?\\.(?:jpg|png|gif))\\b",
    "use_aho": false,
    "message": "Attempt to upload PHP-related or disguised PHP file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-005",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<\\?(php|=)|eval\\s*\\(|system\\s*\\(|exec\\s*\\(|shell_exec\\s*\\(",
    "use_aho": false,
    "message": "Possible PHP webshell payload inside uploaded file",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "detect-jpeg-php-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)\\xFF\\xDA[\\s\\S]{0,20000}\\<\\?php|\\<\\?\\s",
    "use_aho": false,
    "message": "JPEG contains embedded PHP tag between SOS and EOI (possible disguised webshell)",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "upload-php-filename-001",
    "group_id": "UPLOAD",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)filename\\s*=\\s*[^\\r\\n]*\\.(?:php|phtml|php\\d+|php%00|php\\\\x00|jpg\\.php|jpeg\\.php|png\\.php)\\b",
    "use_aho": false,
    "message": "Upload filename indicates disguised PHP (double extension / null byte)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-file-vector-001",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:%!PS|push\\s+graphic-context|viewbox\\s+\\d|image\\s+over|pango:@|xlink:href)",
    "use_aho": false,
    "message": "Possible ImageMagick vector or embedded PostScript content",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-localfile-001",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:/etc/passwd|/etc/shadow|/proc/|/dev/|/root/|file:/)",
    "use_aho": false,
    "message": "Upload references sensitive local path (possible file disclosure)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-command-pipe-001",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:%pipe%|OutputFile\\s*\\(|;\\s*(?:bash|sh|curl|wget|nc|python)|\\|\\s*(?:bash|sh|curl|wget|nc|python))",
    "use_aho": false,
    "message": "ImageMagick PostScript or shell pipe command detected",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-shell-rce-001",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:/bin/(?:bash|sh)|/dev/tcp/|\\bmkfifo\\b|\\bnc\\b|\\bncat\\b|0<&1|2>&1|>|<|\\$\\(.*\\))",
    "use_aho": false,
    "message": "Possible reverse shell or shell command execution",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-url-inject-001",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)url\\s*\\([^)]*[;&|><'\"$]",
    "use_aho": false,
    "message": "Suspicious url(...) containing shell metacharacters",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-url-ssrf-001",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)https?:\\/\\/(?:127\\.|localhost|10\\.|192\\.168\\.|172\\.(1[6-9]|2[0-9]|3[0-1])|169\\.254)",
    "use_aho": false,
    "message": "Request to internal/private IP detected (possible SSRF)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-callback-001",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(burpcollaborator|interact\\.sh|webhook|collab\\.|requestcatcher)",
    "use_aho": false,
    "message": "Callback or exfiltration domain detected",
    "severity": "critical",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-obfuscation-001",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(?:%[0-9A-Fa-f]{2}|&#x[0-9A-Fa-f]{2};|\\\\x[0-9A-Fa-f]{2})",
    "use_aho": false,
    "message": "Encoded or obfuscated payload content (possible evasion attempt)",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-xxe-001",
    "group_id": "IMAGES",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)<!ENTITY\\s+%|<!DOCTYPE[^>]+\\[|SYSTEM\\s+['\"]file:",
    "use_aho": false,
    "message": "Possible XXE payload in uploaded XML/SVG file",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-cve-2021-22204",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(%!PS|%pipe%|/setpagedevice|putdeviceprops|OutputFile\\s*\\(|DjVu|AT&TFORM|FORMDJVU)",
    "use_aho": false,
    "message": "Possible ImageMagick/ExifTool DjVu PostScript RCE (CVE-2021-22204)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "imgmag-exif-rce-001",
    "group_id": "IMAGEMAGICK",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(exiftool|DjVu|%pipe%|/bin/(bash|sh)|curl|wget|OutputFile)",
    "use_aho": false,
    "message": "ExifTool metadata execution attempt (possible CVE-2021-22204)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "png-metadata-php-shell",
    "group_id": "IMAGE_EXPLOIT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(tEXt|iTXt).*<\\?php.*(system|eval|base64_decode|assert|shell|\\$_GET|\\$_POST)",
    "use_aho": false,
    "message": "Suspicious PHP code embedded in PNG metadata (Pillow/Exif injection)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "png-metadata-suspicious-key",
    "group_id": "IMAGE_EXPLOIT",
    "proto": "TCP",
    "dst_port": 80,
    "pattern_regex_bytes": "(?is)(tEXt|iTXt)\\s*(Comment|Description|shell|meta|php|cmd)",
    "use_aho": false,
    "message": "Suspicious PNG metadata key (possible malicious file generation)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null
  },
  {
    "uuid": "python-pillow-malicious-metadata",
    "group_id": "CODE_GENERATION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)PIL\\.PngImagePlugin|meta\\.add_text\\(|im\\.info\\[.*?shell\\]|im\\.save\\(.*?pnginfo\\)",
    "use_aho": false,
    "message": "Python script embedding PHP shell into PNG metadata (Pillow exploit generator)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "ssi-exec-shell-commands",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!--\\s*#exec\\b[^>]*?cmd\\s*=\\s*(?:\"|')?[^\\\"'>]*?(?:/bin/cat|/etc/passwd|/etc/shadow|/usr/bin/id|/bin/ls|/usr/bin/netstat|/usr/bin/id;)[^\\\"'>]*?(?:\"|')?[^>]*?-->",
    "use_aho": false,
    "message": "SSI #exec payload attempting to run shell commands (cat /etc/passwd, id, ls, netstat, ...)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "inline-shell-separators-pipes-backticks",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[;\\|&]\\s*(?:/usr/bin/id|/bin/ls|/bin/cat|netstat|id|ls)\\b|`[^`]{0,300}\\b(?:/usr/bin/id|/bin/ls|/bin/cat|id)\\b[^`]{0,300}`|\\b(?:/usr/bin/id|/bin/ls|/bin/cat)\\b\\s*;)",
    "use_aho": false,
    "message": "Inline shell separators, pipes or backticks with common command names (id, ls, cat, netstat)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "system-popen-exec-php-constructs",
    "group_id": "CODE_INJECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)\\b(?:system|exec|popen|passthru|shell_exec)\\s*\\(\\s*['\\\"][^'\\\"]*(?:cat\\s+/etc/passwd|/usr/bin/id|id|/bin/ls|netstat|ping)[^'\\\"]*['\\\"]\\s*\\)",
    "use_aho": false,
    "message": "Use of runtime execution functions (system/exec/popen/...) with suspicious command strings",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "encoded-newline-and-percent-encoding-commands",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)(?:%0a|%0A|\\n)\\s*(?:cat%20/etc/passwd|/usr/bin/id|id|/bin/ls|/usr/bin/id|ping\\b|netstat\\b)",
    "use_aho": false,
    "message": "Percent-encoded or literal newline followed by suspicious command (cat /etc/passwd, id, ls, ping, netstat)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "suspicious-ping-netstat-longrun",
    "group_id": "DOS_AND_RECON",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:\\&\\s*ping\\b|;\\s*ping\\b|\\|\\s*ping\\b|\\bping\\s+-[in]\\b|\\bnetstat\\s+-)",
    "use_aho": false,
    "message": "Ping/netstat usage attempts (possible recon/long-run command injection)",
    "severity": "medium",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "suspicious-vertical-bars-and-ids",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:\\|\\s*/usr/bin/id\\b|\\|\\s*id\\b|\"\\|/usr/bin/id\\|\"|'\\|/usr/bin/id\\|'|\\|id\\||\\|/usr/bin/id\\|)",
    "use_aho": false,
    "message": "Patterns containing pipes/vertical-bars around 'id' or '/usr/bin/id' (common in injected payloads)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "semicolon-id-variants",
    "group_id": "WEB_PAYLOADS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:;\\s*id\\s*;|;id;|;\\s*/usr/bin/id\\s*;|\\b\\w+\\)\\s*;\\s*id\\b|\\b\\w+;\\s*/usr/bin/id\\b)",
    "use_aho": false,
    "message": "Semicolon-wrapped 'id' variants and common payload fragments (e.g. a);id )",
    "severity": "medium",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_shellshock",
    "group_id": "WEB_RCE",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)\\(\\)\\s*\\{\\s*:\\s*;\\s*\\}\\s*;?\\s*[-`\\w\\\"'\\s\\(\\)\\./:@%?=&+\\$\\\\]*?(?:\\b(?:curl|wget|sleep|uname|whoami|nc|/usr/bin/id|/bin/ls|/bin/cat|perl|bash|echo)\\b|`[^`]{1,400}`|\\$\\([^\\)]{1,400}\\))",
    "use_aho": false,
    "message": "Shellshock-style payload or immediate command substitution/download following '() { :; };' pattern",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_cmdsub_and_backticks",
    "group_id": "WEB_RCE",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:`[^`]{1,500}`|\\$\\(\\s*[^\\)]{1,500}\\s*\\)|\\$\\s*\\{\\s*[^\\}]{1,300}\\s*\\})\\s*(?:;|\\||&|\\)|\\{|\\[|\\s|$).*?(?:\\b(?:id|/usr/bin/id|whoami|/bin/ls|ls\\b|/bin/cat|cat\\b|curl\\b|wget\\b|nc\\b|perl\\b|phpinfo\\b|netstat\\b)\\b)",
    "use_aho": false,
    "message": "Command substitution / backticks / ${...} containing common commands (id, ls, cat, curl, wget, nc, phpinfo, ...)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_operators_percent_newline",
    "group_id": "WEB_RCE",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:%0a|%0A|%0d|%0D|\\n|\\r|\\\\n|\\\\r)\\s*(?:/usr/bin/id|id\\b|whoami\\b|/bin/ls|ls\\b|/bin/cat|cat\\b|curl\\b|wget\\b|nc\\b|netstat\\b|phpinfo\\b|ping\\b)|(?:[\\|&;]{1,2}\\s*(?:/usr/bin/id|id\\b|whoami\\b|/bin/ls|ls\\b|/bin/cat|cat\\b|curl\\b|wget\\b|nc\\b|perl\\b|phpinfo\\b|netstat\\b|net\\s+user|net\\s+localgroup|reg\\s+add|ipconfig|ifconfig|dir\\b|type\\b))|(?:\\b[a-zA-Z0-9_]{0,12}[\\)\\]]?\\s*[;\\|]\\s*(?:id\\b|/usr/bin/id|whoami\\b|/bin/ls|ls\\b|/bin/cat|cat\\b))",
    "use_aho": false,
    "message": "Command chaining operators (|, ||, &, &&, ;) or encoded newlines followed by suspicious commands",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_php_eval_system_echo_write",
    "group_id": "CODE_EXECUTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)\\b(?:eval|exec|system|shell_exec|passthru|popen|pcntl_exec)\\s*\\(\\s*['\\\"][^'\\\"]{0,1000}(?:/etc/passwd|/etc/shadow|/usr/bin/id|id\\b|whoami\\b|/bin/ls|ls\\b|curl\\b|wget\\b|nc\\b|phpinfo\\b|netstat\\b)[^'\\\"]*['\\\"]\\s*\\)|<\\?php[^>]{0,800}?(?:system|exec|shell_exec|passthru|phpinfo|`)[^>]*\\?>|\\becho\\b\\s*[\"']\\s*<\\?php[^\"']*\\?>\\s*[\"']\\s*>\\s*\\w+\\.php|\\{\\s*\\$?\\s*\\{\\s*(?:phpinfo|sleep)\\s*\\(\\s*\\d{1,4}\\s*\\)\\s*\\}\\s*\\}|\\{\\{\\s*get_user_file\\s*\\(|\\{\\{\\s*person\\.secret|\\{\\{\\s*person\\.name",
    "use_aho": false,
    "message": "Runtime eval/exec/system or PHP tags / echo write-to-file / template-injection (phpinfo/sleep/get_user_file etc.)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "rce_gop_rev_shell_perl_windows_flood",
    "group_id": "DOS_RCE",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:\\b(?:curl|wget)\\b[^\\s]{0,600}https?://[\\w\\-\\.:@/\\?=&#%+~_\\[\\]\\$`'\"\\\\\\(\\)-]{10,}|\\bnc\\b\\s*(?:-l|-lvvp|\\-e)?\\s*\\d{2,5}\\s*(?:-e\\s*/bin/sh)?|\\bnc\\s+\\-e\\b|\\bperl\\b\\s*-e\\s*'print\\s+\"X\"x\\d{3,6}'|\\bperl\\b\\s*-e\\s*'print\\s+\"X\"x\\d{3,6}'|\\btype\\b\\s+C:\\\\Windows\\\\repair\\\\SAM|\\btype\\b\\s+C:\\\\boot.ini|\\bnet\\s+localgroup\\s+Administrators|\\bnet\\s+user\\b|\\breg\\s+add\\s+\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\"|\\bnetsh\\b\\s+firewall|\\bipconfig\\b\\s*/all|\\bdir\\s+C:\\\\Users|\\bwhoami\\b|\\bwhich\\s+(?:curl|gcc|nc|perl|python|wget)\\b)",
    "use_aho": false,
    "message": "Download/reverse-shell (curl/wget/nc), perl flood, Windows RCE/admin commands, reconnaissance commands (whoami/which/etc.)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_double_slash_domain_bypass",
    "group_id": "URL_BYPASS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[\\/\\\\%]{2,}|(?:%2f|%5c|%09|%00){2,})\\s*[-\\w%\\.]{0,50}\\.(?:com|net|org|io|vn|xyz|example)\\b",
    "use_aho": false,
    "message": "URL bypass using repeated slashes/backslashes/encoded-slashes before domain (e.g. //example.com, /%2f%2fexample.com, \\\\example.com)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_encoded_or_malformed_scheme",
    "group_id": "URL_BYPASS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:%68%74%74%70%3a%2f%2f|%68%74%74%70|https?:)(?:%3a|:)?(?:%2f|\\/){1,3}[-\\w%:\\.@\\/\\\\]+\\.(?:com|net|org|io|vn|xyz|example)\\b",
    "use_aho": false,
    "message": "Encoded or malformed HTTP(S) scheme used to hide external target (hex-encoded http://, http:/, https:/// etc.)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_open_redirect_param_bypass",
    "group_id": "OPEN_REDIRECT",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)[\\?&](?:url|next|redirect|redir|rurl|redirect_uri)\\s*=\\s*(?:\\/+|(?:\\\\/)|(?:%2f)+|%5c+|https?:|\\/\\/)",
    "use_aho": false,
    "message": "Open-redirect parameter contains absolute/escaped/encoded external target (e.g. ?url=//example.com, ?redirect=/\\/example.com, ?url=Https://example.com)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_traversal_with_domain_or_encoded_dots",
    "group_id": "PATH_TRAVERSAL",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:\\.(?:\\.|%2e%2e)|%2e%2e|\\/\\.\\.|\\/(?:%2f|%2e|\\.){0,2}\\.{1,2})[^\\s]{0,80}\\.(?:com|net|org|io|vn|xyz|example)\\b|\\/(?:[\\w%\\-\\.\\/]*)(?:%2e%2e|\\.\\.|%2f%2e%2e)\\b",
    "use_aho": false,
    "message": "Path traversal or encoded '..' combined with domain/path (e.g. /example.com/%2e%2e, ////example.com/%2e%2e%2f)",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_control_unicode_separator_bypass",
    "group_id": "URL_BYPASS_MISC",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:%00|%09|%0a|%0d|%e3%80%82|\\<\\>|\\\\;@|\\;@|\\s\\/{2,}[^\\s]*\\;@|%5c;@)|(?:google%00|google%E3%80%82|\\<\\>\\/\\/[-\\w%\\.]+)",
    "use_aho": false,
    "message": "Control/unicode/null/tab or exotic separator bypass attempts (null/tab/unicode dots, \\;@, <> , etc.) used to hide external redirect/SSRF",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "oss_leading_dot_domain",
    "group_id": "URL_BYPASS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^[.]([A-Za-z0-9-]+[.])*[A-Za-z]{2,}$",
    "use_aho": false,
    "message": "Leading-dot domain in path (e.g. /.example.com) — likely SSRF/redirect obfuscation",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_duplicate_param_backref",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[?&])([A-Za-z0-9_\\-]+)=.*[?&]\\1=",
    "use_aho": false,
    "message": "Duplicate HTTP parameter name detected (possible HPP) — same parameter appears multiple times in query string",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_array_param_duplicate",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[?&])([A-Za-z0-9_\\-]+)\\[\\]=.*[?&]\\1\\[\\]=",
    "use_aho": false,
    "message": "Duplicate array-style parameter detected (param[]=... repeated) — possible HPP/parameter smuggling",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_encoded_ampersand_in_value",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[?&][A-Za-z0-9_\\-]+=)[^\\r\\n]{0,200}(?:%26|%3[Bb]|%3b|%3B)(?:[A-Za-z0-9_\\-]+)=|(?:%26|%3[Bb]|%3b|%3B)(?:[A-Za-z0-9_\\-]+)=%",
    "use_aho": false,
    "message": "Encoded ampersand/semicolon (%26 / %3B) inside parameter value that may create additional params when decoded — possible HPP/parameter smuggling",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_null_byte_in_param",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:%00|\\x00|\\u0000)",
    "use_aho": false,
    "message": "Null byte detected in request (encoded or literal) — may be used to bypass parsing/validation (HPP or other injection)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_semicolon_param_smuggling",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)[?&][^=\\s]{1,80}=[^\\r\\n]{0,200};[^=\\s]{1,80}=[^\\r\\n]{0,200}",
    "use_aho": false,
    "message": "Semicolon used inside query parameter values to inject additional key=value pairs — possible parameter smuggling / HPP",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_double_encoded_param_name",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:%25|%)[0-9A-Fa-f]{2}([A-Za-z0-9_\\-]+)=(?:.*)(?:%25|%)[0-9A-Fa-f]{2}\\1=",
    "use_aho": false,
    "message": "Double-encoded parameter name pattern detected (attempt to hide duplicate param names) — likely HPP evasion",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_leading_dot_path_param_combo",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[\\/]{1,}\\.\\w{2,}[-\\w]*\\.(?:com|net|org|io|vn|example)\\b).*([?&][A-Za-z0-9_\\-]+=).*[?&]\\1=",
    "use_aho": false,
    "message": "Leading-dot domain in path combined with duplicate parameter name — obfuscated exploit pattern (HPP + redirect/SSRF obfuscation)",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "hpp_multiple_repeats_suspect",
    "group_id": "HPP_ATTACK",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:[?&][A-Za-z0-9_\\-]+=)[^\\r\\n]{0,200}(?:[?&][A-Za-z0-9_\\-]+=)[^\\r\\n]{0,200}(?:[?&][A-Za-z0-9_\\-]+=)",
    "use_aho": false,
    "message": "Three or more parameters in short query string segment — suspicious repetition/packing which can indicate HPP or param-smuggling attempts",
    "severity": "medium",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_multiple_header_raw",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:\\r\\n|\\n)Host:\\s*[^\\r\\n]+(?:\\r\\n|\\n).*?(?:\\r\\n|\\n)Host:\\s*[^\\r\\n]+",
    "use_aho": false,
    "message": "Multiple Host headers detected in raw request (RFC violation) — possible header injection/request smuggling",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_null_crlf_percent_encoding",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)(?:%0d|%0a|%00|\\x00|\\r|\\n)",
    "use_aho": false,
    "message": "Host header contains CRLF/null byte/percent-encoded newline — possible header injection / CRLF attack",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_contains_path_or_at_symbol",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^(?:[^\\r\\n]*[\\/@][^\\r\\n]*|.*\\/.*)$",
    "use_aho": false,
    "message": "Host header contains path component or '@' userinfo which is suspicious — possible host header manipulation",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_leading_dot_or_ip_with_port",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^(?:\\.|\\d+\\.\\d+\\.\\d+\\.\\d+:)",
    "use_aho": false,
    "message": "Host header starts with a leading dot or IP:port — suspicious or may indicate obfuscation",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "host_not_in_whitelist",
    "group_id": "HOST_HEADER",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?i)^(?!.*\\b(?:app\\.example\\.com|api\\.example\\.com|localhost|127\\.0\\.0\\.1)\\b).*$",
    "use_aho": false,
    "message": "Host header not matching configured whitelist for this service — potential host header injection",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xml_non_xml_content_scan",
    "group_id": "GENERAL",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:<\\?xml|<!DOCTYPE|<!ENTITY|<xsl:stylesheet|php:function\\(|data:[^;]+;base64,)",
    "use_aho": false,
    "message": "XML/DTD/XSLT signatures found in request body (scan regardless of Content-Type)",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_doctype_decl",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!DOCTYPE\\s+[^>]+>",
    "use_aho": false,
    "message": "XXE: DOCTYPE declaration found — potential XXE initialization",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_doctype_percent_encoded",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(%3C|%253C)\\s*!DOCTYPE|!DOCTYPE\\s*(%3E|%253E)",
    "use_aho": false,
    "message": "XXE: Encoded DOCTYPE pattern detected — possible obfuscation",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_param_entity_decl",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!ENTITY\\s+%\\s*[A-Za-z0-9_\\-]+\\s+SYSTEM\\s+[\"'][^\"']+[\"']",
    "use_aho": false,
    "message": "XXE: Parameter ENTITY (%name SYSTEM '...') declaration — critical",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_param_entity_ref",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)%\\s*[A-Za-z0-9_\\-]+\\s*;",
    "use_aho": false,
    "message": "XXE: Parameter entity reference (%name;) detected — likely external DTD usage",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_entity_system_any_scheme",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!ENTITY\\s+[^>]+SYSTEM\\s+[\"']\\s*[A-Za-z0-9+\\-.]+:\\/\\/[^\"']+[\"']",
    "use_aho": false,
    "message": "XXE: ENTITY SYSTEM references a URI (file/http/php/data...) — possible XXE or SSRF",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_entity_system_encoded_uri",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(file|http|https|php)%3A%2F%2F",
    "use_aho": false,
    "message": "XXE: Encoded URI scheme detected (file/http/php) — obfuscation attempt",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_entity_system_relative",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!ENTITY\\s+[^>]+SYSTEM\\s+[\"']\\s*(?:\\.{0,3}\\/?[A-Za-z0-9._\\-/\\\\]+\\.(?:ini|txt|conf|log|xml))[\"']",
    "use_aho": false,
    "message": "XXE: ENTITY SYSTEM references local/relative file — file inclusion attempt",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_entity_system_php_filter",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)php:\\/\\/filter\\/[^\"']+",
    "use_aho": false,
    "message": "XXE: ENTITY SYSTEM using php://filter — exfiltration attempt",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_entity_system_data_base64",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)data:[^;]+;base64,[A-Za-z0-9+/=]{8,}",
    "use_aho": false,
    "message": "XXE: ENTITY SYSTEM uses base64-encoded data URI — obfuscated XXE",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_many_entity_decls",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:<!ENTITY\\s+[^>]*>\\s*){4,}",
    "use_aho": false,
    "message": "XXE: Multiple ENTITY declarations — potential Billion Laughs attack",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_entity_value_recursion",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!ENTITY\\s+[A-Za-z0-9_\\-]+\\s+\"(?:&[A-Za-z0-9_\\-]+;){3,}\">",
    "use_aho": false,
    "message": "XXE: ENTITY recursively referencing others — exponential expansion vector",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xxe_many_entity_refs",
    "group_id": "XXE_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)(?:&[A-Za-z0-9_\\-]+;){8,}",
    "use_aho": false,
    "message": "XXE: excessive entity references in body — post-expansion DoS attempt",
    "severity": "high",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xsl_document_function",
    "group_id": "XSLT_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<xsl:stylesheet[^>]*>|<\\?xml-stylesheet|document\\s*\\(",
    "use_aho": false,
    "message": "XSLT stylesheet or document() function detected — possible file/remote inclusion",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xsl_php_function_call",
    "group_id": "XSLT_DETECTION",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)php:function\\s*\\(",
    "use_aho": false,
    "message": "XSLT php:function() usage detected — potential RCE or data exfiltration",
    "severity": "critical",
    "action": "block",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  },
  {
    "uuid": "xml_cdata_script_xss",
    "group_id": "XML_XSS",
    "proto": "LOCAL",
    "pattern_regex_bytes": "(?is)<!\\[CDATA\\[.*?(<script|javascript:|onerror|onload).*?\\]\\]>",
    "use_aho": false,
    "message": "XML/CDATA block contains script — possible XSS injection",
    "severity": "high",
    "action": "alert",
    "pattern_bytes": null,
    "pattern_hex": null,
    "dst_port": null
  }
]